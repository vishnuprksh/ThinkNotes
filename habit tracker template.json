{
  "version": "1.0",
  "content": "# Weekly Habit Tracker\n\nWelcome to your personalized weekly habit tracker! This tool helps you visualize your consistency and maintain momentum toward your personal goals. Focus on the process, and the results will follow.\n\n## Overall Progress\nThis section tracks the percentage of your defined habits that have met their weekly target.\n\n**{{progress_bar_display}}**\n\n---\n\n## Habits Summary (Weekly Targets)\n\n{{habit_table_markdown}}\n\n---\n\n### How to Use:\nTo update your progress, simply tell me which habit you completed, and I will update your notes.\n\n*Example: \"I finished reading 30 minutes today.\"*",
  "writerScript": "async ({ db, fetchExternalData }) => {\n  // 1. Drop and Recreate Table with new 'description' column\n  await db.run(\"DROP TABLE IF EXISTS habits;\");\n  await db.run(`\n    CREATE TABLE habits (\n      id INTEGER PRIMARY KEY,\n      name TEXT NOT NULL,\n      description TEXT,\n      target_count INTEGER NOT NULL,\n      current_count INTEGER NOT NULL,\n      is_completed BOOLEAN\n    );\n  `);\n\n  // 2. Insert all data, including new habits and descriptions\n  const habitsToInsert = [\n    [\"Meditate\", \"Practice mindfulness for 15 minutes.\", 5, 3, 0],\n    [\"Read 30 mins\", \"Read a non-fiction book for at least 30 minutes.\", 7, 7, 1],\n    [\"Exercise\", \"Complete a 45-minute workout session.\", 3, 1, 0],\n    [\"Journaling\", \"Write 500 words about the day's events.\", 5, 0, 0], \n    [\"No Sugar\", \"Avoid all added sugars and processed sweets.\", 7, 4, 0]\n  ];\n\n  for (const [name, description, target, current, completed] of habitsToInsert) {\n    await db.run(\n      \"INSERT INTO habits (name, description, target_count, current_count, is_completed) VALUES (?, ?, ?, ?, ?)\",\n      [name, description, target, current, completed]\n    );\n  }\n\n  return \"Habit tracker updated with new schema and data.\";\n}",
  "readerScript": "async ({ db }) => {\n  const result = db.exec(\"SELECT name, description, target_count, current_count, is_completed FROM habits;\");\n  \n  if (!result || result.length === 0) {\n    return {\n      habit_table_markdown: \"| Habit | Description | Progress | Status |\\n|---|---|---|---|\\n| No habits defined. | - | - | - |\",\n      overall_progress_percent: 0,\n      progress_bar_display: \"[----------] 0%\"\n    };\n  }\n\n  const habits = result[0].values.map(row => ({\n    name: row[0],\n    description: row[1],\n    target_count: row[2],\n    current_count: row[3],\n    is_completed: row[4]\n  }));\n\n  let total_habits = habits.length;\n  let completed_habits = habits.filter(h => h.current_count >= h.target_count).length;\n  let overall_progress_percent = total_habits > 0 ? Math.round((completed_habits / total_habits) * 100) : 0;\n\n  // Generate progress bar string (10 characters wide)\n  const bar_length = 10;\n  const filled_chars = Math.floor((overall_progress_percent / 100) * bar_length);\n  const empty_chars = bar_length - filled_chars;\n  const progress_bar_display = `[${'█'.repeat(filled_chars)}${'—'.repeat(empty_chars)}] ${overall_progress_percent}%`;\n\n  // Generate habit table markdown\n  let habit_table_markdown = \"| Habit | Description | Progress | Status |\\n|---|---|---|---|\\n\";\n  \n  habits.forEach(h => {\n    const is_complete = h.current_count >= h.target_count;\n    const status_icon = is_complete ? \"✅ Completed\" : \"⏳ In Progress\";\n    const progress_text = `${h.current_count}/${h.target_count}`;\n    habit_table_markdown += `| **${h.name}** | ${h.description} | ${progress_text} | ${status_icon} |\\n`;\n  });\n\n  return {\n    habit_table_markdown,\n    overall_progress_percent,\n    progress_bar_display\n  };\n}",
  "timestamp": 1768089028594
}